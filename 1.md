一、项目概述（简短）

产品类型：极简 AI 驱动的“能否跑/能跑到什么效果”查询网站（中国版 canyouitrun），并额外输出“鲁大师类估算分与游戏预估帧率”。
用户体验：首页只有一个搜索框（可自动补全游戏）；用户可选择“浏览器检测（粗略）”或“使用开源 Windows 检测器上传硬件 JSON”；后端用 AI 分析并返回结构化结果页面（带广告与推荐链路）。
目标：快速上线、低开发成本、AI 驱动分析，重点是“漂亮的结构化输出 + 可插入联盟推广链接”。
二、关键设计原则

极简前端：搜索框 → 结果页（包含检测上传入口）
所有智能分析由 LLM 完成（结合小规模规则与缓存避免频繁调用）
检测器使用开源方案（只负责采集并上报 JSON），不做复杂本地逻辑
输出须结构化、可渲染并包含置信度与简短说明
变现：结果页插入广告位 + 装机/升级推荐带联盟链接（可配置）
三、总体架构（高层）

前端（静态）：搜索框、游戏建议下拉、结果展示页面、上传检测按钮、广告位占位
Windows 检测器（开源二次封装）：运行并导出 JSON（硬件/微基准可选），将 JSON 上传至 /api/v1/estimate
后端 API + AI 层：
接受硬件 JSON 与游戏 ID → 触发 AI 分析（Prompt + 检索 / 本地小规则）→ 返回结构化结果
缓存常见硬件+游戏组合结果（Redis）
管理/运营接口：配置联盟链接模板、广告位、黑白名单
数据/DB：Postgres（profiles、requests、affiliate-mapping、games 数据）、对象存储（截图/日志）
日志与监控：记录 AI 调用成本与异常，防止滥用
四、建议使用的开源检测器（说明）

要求：能在 Windows 上获取 CPU/GPU/内存/存储/OS/显卡驱动信息，并可导出 JSON 或可由轻包装器解析输出 JSON。
推荐实现方式（Cursor 可选其一）：
Open Hardware Monitor（开源）+ 提供 C# Wrapper，解析传出的硬件字段生成 JSON。
使用由社区维护的 Windows 硬件探测开源项目（例如 Open Hardware Monitor / LibreHardwareMonitor），二次封装为小 exe，输出 JSON。
另可考虑调用 CPU-Z / GPU-Z 的命令行/导出（注意授权），或直接实现基于 WMI/NVAPI/ADL 的小工具（如用 C#）。
要求客户端只做采集与上传：禁止埋广告或私自收集个人敏感数据；必须显示隐私同意。
五、核心 API 规范（Cursor 可直接实现）

POST /api/v1/estimate
功能：接受游戏查询 + 硬件 JSON（来自客户端或手动表单），返回 AI 结构化分析结果。
请求示例：
{
"game_id": "cyberpunk2077",
"game_query": "赛博朋克 2077",
"hardware_profile": { ... }, // 见硬件字段（下节）
"client_type": "detector" | "browser_manual",
"timestamp": 169xxx,
"user_consent": true
}
响应示例（必须返回下面结构化 schema）：
{
"request_id":"uuid-xxx",
"summary": "您的装备可在 1080p 中高特效下以 ~45-60 FPS 运行（估计）。",
"compatibility": "能/勉强/不能",
"recommended_setting": "1080p 高画质 60fps 目标",
"estimated_ld_score": 345000, // 鲁大师类估算（整数，粗略）
"ld_confidence": 0.75, // 0..1
"estimated_fps": { // 每个预设的估计帧率与置信度
"low_720p": {"fps": 95, "conf": 0.9},
"medium_1080p": {"fps": 72, "conf": 0.85},
"high_1080p": {"fps": 46, "conf": 0.7},
"ultra_1440p": {"fps": 24, "conf": 0.5}
},
"subscores": { // 结构化各项能力评分（相对）
"gpu": {"score":155000, "rank":"mid-high"},
"cpu": {"score":95000, "rank":"mid"},
"memory":{"score":28000,"rank":"sufficient"},
"storage":{"score":45000,"rank":"good"}
},
"bottleneck": "gpu",
"upgrade_recommendations":[
{
"component":"GPU",
"suggestion":"升级到 RTX 4070 可将 high_1080p fps 提升至 ~85",
"affiliate_link":"https://tao.example/affiliate?id=xxx",
"expected_fps_gain_pct": 80
}
],
"explainers":[
"解释 1：基于 GPU 的 3DMark 折算及游戏需求数据库计算得到预估。",
"解释 2：鲁大师估算采用模型回归与基线比例映射，误差约 ±15%。"
],
"ads": [ { "slot_id":"banner_top", "ad_html":"..." } ],
"timestamp":169xxx
}
POST /api/v1/upload_profile (可选)
上传并存储 hardware_profile，返回 profile_id 便于后续上传截图或再次查询。
POST /api/v1/upload_screenshot
上传鲁大师截图或用户实际跑分（用于未来训练）；返回 OCR 结果及是否匹配检测 profile。
六、硬件 JSON Schema（最小必需字段）
说明：为降低客户端复杂度，只需收集关键字段（CPU 型号、GPU 型号、VRAM、内存容量/频率、存储类型、OS、是否笔记本）。
示例（简短）：
{
"client_version":"1.0",
"os":{"platform":"Windows","version":"10.0.19045","arch":"x64"},
"is_laptop":false,
"cpu":{"model":"i5-12400","physical_cores":6,"logical_processors":12,"single_core_score":1234},
"gpu":{"vendor":"NVIDIA","model":"RTX 3060","vram_gb":12,"gpu_benchmark":23456},
"memory":{"total_gb":16,"freq_mhz":3200,"channels":2},
"storage":[{"type":"NVMe","model":"Samsung 980 Pro","capacity_gb":1000}],
"micro_benchmarks": {"gpu_render_fps":180}, // 可选
"timestamp":169xxx
}

七、AI 分析流程与 Prompt 设计（关键 - Cursor 可直接套用）
总体思路：后端收到 request → 先应用轻规则（缓存、阈值判断、直接映射常见配置）→ 若无命中，调用大模型（LLM）进行 RAG + 推理 → LLM 返回结构化 JSON（按 schema 返回）→ 后端校验、插入 affiliate link 模板与广告位 → 返回给前端。

模型选择建议
使用商用大模型 API（OpenAI/GPT-4o/GPT-4o-mini/GPT-4o-realtime 或国产模型如文心一言/讯飞等）或自托管 LLM（若预算受限）。
同时保留小型 deterministic 规则及缓存以控制调用频次和成本。
Prompt 模板（中文示例）
System prompt（总体指令）：
你是一个硬件与游戏性能分析助理。输入包含目标游戏、硬件 JSON 及可用的游戏需求数据库条目。请输出严格遵守下列 JSON schema 的结果（列出 schema）。输出要简洁、务实、并提供置信度字段与简要解释。避免编造非确定信息。若不确定，请给出低置信度并建议运行微基准或上传鲁大师截图。
User prompt（示例填充）：
Game: {game_name} (requirements: {game_requirements摘要})
Hardware: {hardware_json}
Rules:

若 GPU 入库匹配到 exact model 且有真实基准，则用基准数据优先。
若未匹配，请按照 GPU 性能等级估算（low/mid/high/enthusiast）。
鲁大师估算：用经验系数把子项映射为“鲁大师分”范围并给定置信度（默认 ±15%）。
请返回 JSON（不要额外解释）并确保字段：compatibility, recommended_setting, estimated_fps, estimated_ld_score, ld_confidence, subscores, bottleneck, upgrade_recommendations, explainers。
注意：返回必须为纯 JSON 字符串，避免任何其他文本。

规避 hallucination（实施要点）
在 prompt 中注入明确的“证据源优先级”与“若无数据则返回 unknown 或低置信度”规则。
使用 Retrieval-Augmented Generation (RAG)：后端先检索本地游戏需求库与已知显卡基准（若匹配到模型，则把这些数据作为 context 一并传给 LLM）。
对关键数字（FPS、分数）加后处理校验：例如 fps 不得超过 GPU 理论上限；若 LLM 返回极端值，后端修正或降置信度。
八、游戏需求库（建议）

必须有一份本地化的游戏需求数据库（中文名 + 对应最低/推荐/高配的硬件需求），便于 RAG 使用。
初期可采用公开来源基础数据并人工校验。
Cursor 可先实现最小库（常见 200 款热门游戏），后续扩展。
九、输出结构化 UI 规范（用于渲染）
页面元素（结果页）：

大标题：游戏名 + “可玩性结论”（彩色标签：能/勉强/不能）
左侧：硬件摘要卡（CPU/GPU/Memory/Storage）
主要区域：总览：推荐设置 + 估计帧率条（低/中/高/超高）
右侧：鲁大师估算卡（大字体得分 + 置信度）
下方：升级建议卡片（每个卡片含 affiliate 链接与预估提升）
广告位：顶部横幅、结果卡片内小广告位（由运营在后台配置）
分享按钮：生成截图/短链
帮助/免责声明：第三方估算声明
十、变现与联盟实现

广告：
页面顶部 banner、结果页右侧或卡片内部插入广告位；支持静态 HTML/JS 广告或在后端插入 ad_html。
联盟/商品推荐：
在 upgrade_recommendations 中包含 affiliate_link 字段（可配置模板），运营人员在后台维护“型号 → 多个 affiliate 链接（京东/淘宝/拼多多）”映射。
点击跳转计入归因（可使用短链 + 跟踪参数），结算交由运营系统。
风险：避免将推广信息伪装为“官方建议”，需明确“推广链接”为广告/联盟。
十一、隐私与法律（必须）

显著声明与用户同意：采集硬件信息仅用于兼容性与估算分析，用户必须明确同意才上传。
不采集不必要的个人敏感信息（用户名、文件路径、硬盘序列号等，除非必要并明确告知）。
关于“鲁大师”品牌：如果未获得授权，在页面显著位置标注“鲁大师类估算 / 第三方估算，非鲁大师官方数据”，并避免使用鲁大师 Logo。
存储与删除：提供用户删除其上传 profile 的接口（或自动过期机制）。
十二、性能与成本控制建议

缓存：常见组合（热门游戏 + 主流硬件）缓存 24-72 小时，避免重复 LLM 调用。
规则优先：对于常见 GPU/CPU，通过本地基准直接计算（无需 LLM），仅在未命中时调用 LLM。
限速与配额：API 请求限速，防止滥用导致成本暴涨。
十三、验收标准（Acceptance Criteria）

前端：
首页有可用搜索框与下拉建议，能提交游戏查询。
结果页能渲染后端返回的结构化结果（保持格式一致）。
检测器：
开源检测器能生成符合硬件 JSON Schema 的文件并成功上传（至少通过样例测试）。
后端：
/api/v1/estimate 能接受硬件 JSON + game_id，按 schema 返回 JSON（包含 estimated_ld_score 与 estimated_fps 等字段）。
对 10 个热门游戏 + 20 个主流配置的请求，平均后端处理时间（含规则判断 + LLM 调用或缓存）< 1.5s（若 LLM 耗时可先返回异步 job）。
商业：
结果页能展示至少一种联盟链接（可点击），并能记录跳转日志。
十四、最低可行交付（MVP）与里程碑（建议 4 周节奏）

周 1（架构 + 后端骨架）
实现 /api/v1/estimate（mock 返回）
建立 Postgres schema（profiles, requests, affiliate_mappings）
准备 200 款热门游戏的小型需求库
周 2（前端 + 客户端）
前端首页（搜索框、下拉）、结果页骨架（样板渲染）
客户端：封装 Open Hardware Monitor 输出 JSON 的小 exe，并实现上传至 /api/v1/estimate（示例包）
周 3（AI 集成 + Prompt）
实现规则优先层（本地基准映射）
实施 LLM 调用 + Prompt 模板，能返回符合 schema 的 JSON（开发时使用 mock/test cases）
缓存层（Redis） & 基本 affiliate mapping
周 4（上线 beta + 收集反馈）
完成前端美化、广告位占位、联盟链接配置
内部 beta 测试与修正，准备上线并开始流量测试
十五、Cursor 开发任务清单（可直接拆 issue）
高优先级（必做）

T1: 实现后端 API /api/v1/estimate（接收硬件 JSON + game_id，返回示例 JSON）
T2: 建表脚本（profiles, requests, affiliate_mappings）
T3: 构建前端首页（搜索框 + 下拉）与结果页渲染逻辑
T4: 封装开源检测器（Open Hardware Monitor 或 LibreHardwareMonitor），实现输出 JSON 的小 exe，并实现上传逻辑
T5: 实现规则层（本地 GPU/CPU 基准匹配并直接计算估算），减少 LLM 调用
T6: 集成 LLM（可配置 provider）并完成 Prompt 模板实现（带 RAG 支持）
中优先级（可后续）

T7: 实现 affiliate mapping 管理界面（运营可添加/编辑链接）
T8: 广告位渲染与广告配置接口
T9: 上传截图 + OCR 管道（用于后续训练模型）
低优先级（后期）

T10: 异步任务队列（若 LLM 响应慢）
T11: 更复杂的 ML 回归模型用于鲁大师估算（当有足够样本）
十六、示例 Prompt（可直接给 Cursor 放入代码）

System: （同上）“你是硬件与游戏性能分析助理…… 返回严格 JSON”
User: 填入 game_name、硬件 JSON、若有本地基准数据则附上
Post-process: 校验 numeric 范围，凡超出合理阈值设低置信度并备注“请上传微基准以提高准确度”。
十七、风险与缓解（简要）

LLM 产生虚假具体数值（如极端 FPS）：使用规则校验 + 降低置信度或拒绝极端值
成本问题：通过缓存、规则优先来降低 LLM 调用次数
法律/品牌风险：避免使用 “鲁大师官方” 表述，显著声明“第三方估算”
十八、交付物（给 Cursor）

可运行的后端服务骨架（含 /api/v1/estimate）
前端静态站点（搜索框 + 结果页）
开源检测器小 exe（或使用示例脚本）与上传 demo
Prompt 模板文件与 LLM 集成代码样例
Affiliate mapping 管理简单 API
部署说明（Dockerfile、简单 docker-compose）